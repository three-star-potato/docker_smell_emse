FROM node:18.15-alpine

WORKDIR /usr/src

COPY . .

RUN npm install -g pnpm && \
    pnpm install && \
    pnpm run build

COPY hack ./

ENV HOST=0.0.0.0 PORT=3000 NODE_ENV=production LANG=C.UTF-8

EXPOSE 3000

RUN chmod +x ./docker-entrypoint.sh

CMD ["/bin/sh", "docker-entrypoint.sh"]