FROM archlinux/archlinux:latest
RUN pacman -Syu --noconfirm && \
    pacman -S --noconfirm --needed base-devel git gcc clang lua luarocks sdl2 vim bash-completion sudo && \
    useradd -m -G wheel -s /bin/bash docker && \
    echo '%wheel ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers && \
    mkdir -p /home/docker/.config/nelua && \
    echo "return {}" >> /home/docker/.config/nelua/neluacfg.lua
USER docker
RUN sudo luarocks install cluacov && \
    sudo luarocks install luacheck
WORKDIR /mnt